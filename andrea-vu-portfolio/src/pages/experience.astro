---
import Layout from '../layouts/Layout.astro';
import Navigation from '../components/Navigation.astro';
import { getCollection } from 'astro:content';

const experiences = (await getCollection('experiences')).sort((a, b) => (a.data.order || 999) - (b.data.order || 999));

const professional = experiences.filter(exp => exp.data.type === 'professional');
const education = experiences.filter(exp => exp.data.type === 'education');
const extracurricular = experiences.filter(exp => exp.data.type === 'extracurricular');
---

<Layout title="Experience - Andrea Vu">
  <Navigation />

  <main class="min-h-screen bg-white">
    <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-16 sm:py-20 lg:py-24">
      <h1 class="text-5xl sm:text-6xl font-extrabold mb-16 text-gray-900 leading-tight">Experience</h1>

      <!-- Professional -->
      <section class="mb-20">
        <h2 class="text-3xl sm:text-4xl font-bold mb-10 text-gray-900 pb-4 border-b-2 border-purple-200">Professional</h2>
        <div class="space-y-12 lg:space-y-16">
          {professional.map(async (exp) => {
            const { Content } = await exp.render();
            return (
              <article class="relative pl-8 border-l-4 border-purple-200 hover:border-purple-400 transition-colors">
                <div class="absolute -left-2.5 top-2 w-5 h-5 rounded-full bg-purple-400 border-4 border-white"></div>

                <h3 class="text-2xl lg:text-3xl font-bold text-gray-900 mb-2">
                  {exp.data.title}
                </h3>
                <p class="text-xl text-gray-700 mb-2 font-medium">
                  {exp.data.organization}
                </p>
                <p class="text-sm font-medium text-gray-500 mb-6">
                  {exp.data.startDate} - {exp.data.endDate || 'Present'}
                </p>

                <div class="prose prose-gray max-w-none
                  prose-p:text-gray-700 prose-p:text-base prose-p:leading-relaxed prose-p:my-4
                  prose-ul:text-gray-700 prose-ul:my-4 prose-ul:list-disc prose-ul:pl-6
                  prose-li:my-2 prose-li:text-base prose-li:leading-relaxed
                  prose-h2:text-xl prose-h2:font-bold prose-h2:mt-8 prose-h2:mb-4
                  prose-hr:my-8 prose-hr:border-gray-300">
                  <Content />
                </div>

                {exp.data.skills && exp.data.skills.length > 0 && (
                  <div class="mt-6 flex flex-wrap gap-2">
                    {exp.data.skills.map((skill) => (
                      <span class="px-3 py-1.5 bg-purple-50 text-purple-700 text-sm font-medium rounded-lg">
                        {skill}
                      </span>
                    ))}
                  </div>
                )}
              </article>
            );
          })}
        </div>
      </section>

      <!-- Education -->
      <section class="mb-20">
        <h2 class="text-3xl sm:text-4xl font-bold mb-10 text-gray-900 pb-4 border-b-2 border-purple-200">Education</h2>
        <div class="space-y-12 lg:space-y-16">
          {education.map(async (exp) => {
            const { Content } = await exp.render();
            return (
              <article class="relative pl-8 border-l-4 border-purple-200 hover:border-purple-400 transition-colors">
                <div class="absolute -left-2.5 top-2 w-5 h-5 rounded-full bg-purple-400 border-4 border-white"></div>

                <h3 class="text-2xl lg:text-3xl font-bold text-gray-900 mb-2">
                  {exp.data.title}
                </h3>
                <p class="text-xl text-gray-700 mb-2 font-medium">
                  {exp.data.organization}
                </p>
                <p class="text-sm font-medium text-gray-500 mb-6">
                  {exp.data.startDate} - {exp.data.endDate || 'Present'}
                </p>

                <div class="prose prose-gray max-w-none
                  prose-p:text-gray-700 prose-p:text-base prose-p:leading-relaxed prose-p:my-4
                  prose-ul:text-gray-700 prose-ul:my-4 prose-ul:list-disc prose-ul:pl-6
                  prose-li:my-2 prose-li:text-base prose-li:leading-relaxed
                  prose-h2:text-xl prose-h2:font-bold prose-h2:mt-8 prose-h2:mb-4
                  prose-strong:font-bold prose-strong:text-gray-900
                  prose-hr:my-8 prose-hr:border-gray-300">
                  <Content />
                </div>
              </article>
            );
          })}
        </div>
      </section>

    </div>
  </main>
</Layout>
